//Simple Encryptor --HTB
#include <stdio.h>
#include <stdlib.h>

int main() {
    unsigned int seed;
    long i;
    int en1,en2;
    FILE *enflag = fopen("flag.enc", "rb");

    if (enflag == NULL) {
        printf("Could not open the file.\n");
        return 1;
    }

    // read the first 4 bytes (seed)
    fread(&seed, 1, 4, enflag);

    // determine the file size
    fseek(enflag, 0, SEEK_END);
    size_t size = ftell(enflag);
    fseek(enflag, 0, SEEK_SET);

    // allocate memory to store file content
    unsigned char *flag = malloc(size);

    // read the file content
    fread(flag, 1, size, enflag);

    fclose(enflag);

    srand(seed);
    // printf("%d\n", rand());
    for(i = 4; i < (long)size; i++) {
        en1 = rand();
        en2 = rand();
        en2 = en2 & 7;
        flag[i]  =  flag[i] >> en2 |flag[i] << 8 - en2;
        flag[i] = en1 ^ flag[i];
        printf("%c", flag[i]);
    }
  
    return 0;
}
